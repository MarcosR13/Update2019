Sub CopiarMelhorCusto()
    Dim wsPainel As Worksheet
    Dim wsDados As Worksheet
    Dim wsResultados As Worksheet
    Dim ultimaLinha As Long
    Dim melhorCusto As Double
    Dim i As Long
    Dim criterio1 As Boolean
    Dim criterio2 As Boolean
    Dim criterio3 As Boolean
    Dim criterio4 As Boolean
    Dim criterio5 As Boolean
    Dim criterio6 As Boolean
    Dim criterio7 As Boolean
    Dim rng As Range
    Dim custo As Double
    Dim primeiraLinha As Long
    
    ' Definindo as planilhas
    Set wsPainel = ThisWorkbook.Sheets("Painel")
    Set wsDados = ThisWorkbook.Sheets("Dados") ' Ajuste se necessário
    On Error Resume Next
    Set wsResultados = ThisWorkbook.Sheets("Resultados")
    On Error GoTo 0
    
    ' Se a aba "Resultados" não existir, cria uma nova
    If wsResultados Is Nothing Then
        Set wsResultados = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))
        wsResultados.Name = "Resultados"
    Else
        ' Limpa os dados existentes na aba "Resultados"
        wsResultados.Cells.Clear
    End If

    ' Encontrar a última linha com dados na planilha de dados
    ultimaLinha = wsDados.Cells(wsDados.Rows.Count, "G").End(xlUp).Row

    ' Coletar valores dos critérios
    criterio1 = wsPainel.Range("$C$7").Value
    criterio2 = wsPainel.Range("$C$3").Value
    criterio3 = wsPainel.Range("$C$4").Value
    criterio4 = wsPainel.Range("$C$5").Value
    criterio5 = wsPainel.Range("$C$6").Value
    criterio6 = wsPainel.Range("$C$2").Value

    melhorCusto = Application.WorksheetFunction.Max(wsDados.Range("G:G"))

    ' Encontrar o menor custo baseado nos critérios e copiar a linha correspondente
    For i = 2 To ultimaLinha ' Presumindo que a linha 1 é o cabeçalho
        ' Definindo os critérios para o MinIfs
        If criterio1 Then
            If wsDados.Cells(i, "D").Value = wsDados.Cells(2, "D").Value And _
               wsDados.Cells(i, "E").Value = wsDados.Cells(2, "E").Value Then
                custo = wsDados.Cells(i, "G").Value
            End If
        End If
        If criterio2 Then
            If wsDados.Cells(i, "B").Value = wsDados.Cells(2, "B").Value Then
                custo = wsDados.Cells(i, "G").Value
            End If
        End If
        If criterio3 Then
            If wsDados.Cells(i, "A").Value = "LICANIA" Then
                custo = wsDados.Cells(i, "G").Value
            End If
        End If
        If criterio4 Then
            If wsDados.Cells(i, "A").Value = "NASSAU" Then
                custo = wsDados.Cells(i, "G").Value
            End If
